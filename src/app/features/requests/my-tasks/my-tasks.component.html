<app-header></app-header>

<div class="tasks-container">
  <div class="tasks-header">
    <h1>&nbsp;</h1>
  </div>

  @if (errorMessage) {
    <div class="error-alert">
      {{ errorMessage }}
    </div>
  }

  @if (isLoading) {
    <div class="loading-message">
      Loading tasks...
    </div>
  } @else {
    <div class="tasks-table-container">
      @if (tasks.length === 0) {
        <div class="empty-state">
          <p>No tasks found.</p>
        </div>
      } @else {
        <table class="tasks-table">
          <thead>
            <tr>
              <th>Request #</th>
              <th>Employee</th>
              <th>Service Type</th>
              <th>Submission Date</th>
              <th>Last Updated</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            @for (task of tasks; track task.id) {
              <tr class="table-row">
                <td>
                  <a [routerLink]="['/my-tasks', task.id]" class="task-link">{{ task.id }}</a>
                </td>
                <td>{{ task.employee || 'N/A' }}</td>
                <td>{{ task.serviceType || 'N/A' }}</td>
                <td>{{ task.submissionDate || 'N/A' }}</td>
                <td>{{ task.lastUpdated || 'N/A' }}</td>
                <td>
                  <span class="status-badge" [ngClass]="getStatusClass(task.status)">
                    {{ getStatusDisplay(task.status) }}
                  </span>
                </td>
                <td>
                  <div class="action-buttons">
                    <button class="action-btn approve" [routerLink]="['/my-tasks', task.id]" title="View & Approve">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                    <button class="action-btn reject" [routerLink]="['/my-tasks', task.id]" title="View & Reject">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                    <button class="action-btn view" [routerLink]="['/my-tasks', task.id]" title="View Details">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke="currentColor" stroke-width="2"/>
                        <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                      </svg>
                    </button>
                  </div>
                </td>
              </tr>
            }
          </tbody>
        </table>
      }
    </div>
  }
</div>
